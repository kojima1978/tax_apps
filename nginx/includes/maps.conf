# ============================================
# WebSocket Upgrade Map
# ============================================
map $http_upgrade $connection_upgrade {
    default upgrade;
    '' '';
}

# ============================================
# Next.js Font Routing (Turbopack dev mode)
# ============================================
map $http_referer $nextjs_font_backend {
    default portal-app:3000;
    ~*/tax-docs/ tax-docs-frontend:3005;
    ~*/itcm/ itcm-frontend:3020;
    ~*/medical/ medical-stock-valuation:3010;
    ~*/inheritance-tax-docs/ inheritance-tax-docs:3003;
    ~*/gift-tax-simulator/ gift-tax-simulator:3001;
    ~*/gift-tax-docs/ gift-tax-docs:3002;
    ~*/retirement-tax-calc/ retirement-tax-calc:3013;
}
