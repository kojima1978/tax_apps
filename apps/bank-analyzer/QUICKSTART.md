# クイックスタートガイド

このガイドでは、サンプルデータを使って5分で動作確認ができます。

## 1. セットアップ（初回のみ）

```bash
# プロジェクトディレクトリに移動
cd inheritance-bank-analyzer

# 必要なライブラリをインストール
pip install -r requirements.txt
```

## 2. アプリケーション起動

```bash
# Streamlitアプリを起動
streamlit run main.py
```

または

```bash
python -m streamlit run main.py
```

ブラウザが自動で開き、http://localhost:8501 にアクセスされます。

## 3. サンプルデータでテスト

### ステップ1: 案件作成
1. 左サイドバーの「案件一覧」をクリック
2. 「新規案件作成」に「テスト案件」と入力
3. 「作成」ボタンをクリック
4. 作成された「テスト案件」の「選択」ボタンをクリック

### ステップ2: 1つ目の口座データをインポート
1. 左サイドバーの「CSVインポート」をクリック
2. 「通帳CSVを選択」で `sample_data/三菱UFJ銀行_sample.csv` を選択
3. 口座情報を入力:
   - **銀行名**: 三菱UFJ銀行
   - **支店名**: 青山支店
   - **口座種別**: 普通
   - **口座番号**: 1234567
   - **名義人**: 山田太郎
4. 「読み込み・検証」ボタンをクリック
5. プレビューを確認後、「このデータを登録して分析を実行する」をクリック

### ステップ3: 2つ目の口座データをインポート
1. 同じく「CSVインポート」画面で、`sample_data/みずほ銀行_sample.csv` を選択
2. 口座情報を入力:
   - **銀行名**: みずほ銀行
   - **支店名**: 渋谷支店
   - **口座種別**: 普通
   - **口座番号**: 9876543
   - **名義人**: 山田花子
3. 「読み込み・検証」→「登録して分析を実行する」

### ステップ4: 分析結果を確認
1. 左サイドバーの「分析・表示」をクリック
2. 3つのタブを確認:

#### 資金移動フローのタブ
- 三菱UFJ銀行からみずほ銀行への資金移動（150万円）がサンクダイアグラムで表示されます
- 2024年2月5日に出金、2月7日に入金（日付差2日）という近接性から自動検知されています

#### 多額取引のタブ
- 100万円以上の取引が一覧表示されます
- 三菱UFJ銀行の150万円振込、200万円入金
- みずほ銀行の150万円入金、120万円出金

#### 全取引一覧のタブ
- 全取引データを表形式で確認できます
- 口座絞り込みや摘要検索が可能です
- `is_large` や `is_transfer` フラグで自動検知結果を確認できます

## 4. 実際のデータで使用する場合

### CSVフォーマット
```csv
銀行名,年月日,摘要,払戻,お預り,差引残高
三菱UFJ銀行,2024-01-15,ATM引出,100000,0,900000
```

- **年月日**: YYYY-MM-DD形式（例: 2024-01-15）
- **摘要**: 取引内容
- **払戻**: 出金額（数値のみ、カンマは自動除去）
- **お預り**: 入金額（数値のみ）
- **差引残高**: 残高（数値のみ）

### 注意事項
1. CSVはUTF-8またはShift-JISでエンコードしてください
2. 銀行名のカラムは必須ですが、実際には使用されません（口座情報入力時に設定）
3. 金額はカンマ付きでもOKです（自動で除去されます）

## 5. 設定のカスタマイズ

`lib/config.py` を編集して閾値を変更できます。

```python
LARGE_AMOUNT_THRESHOLD = 1_000_000      # 多額取引の閾値（デフォルト: 100万円）
TRANSFER_DAYS_WINDOW = 3                # 資金移動の日付誤差範囲（デフォルト: ±3日）
TRANSFER_AMOUNT_TOLERANCE = 500         # 資金移動の金額誤差範囲（デフォルト: ±500円）
```

## トラブルシューティング

### Streamlitが見つからない
```bash
# Pythonパスの問題の場合
python -m pip install streamlit

# または
pip install --user streamlit
```

### 残高不整合エラー
- OCRの読み取りミスの可能性があります
- 元のCSVファイルを確認し、数値が正しいか確認してください

### データが表示されない
- 案件を選択しているか確認してください
- CSVインポート時にエラーが出ていないか確認してください

## 次のステップ

詳細なドキュメントは [README.md](README.md) を参照してください。

今後のバージョンでは、以下の機能追加を予定しています:
- LLM（Ollama）による摘要文の自動分類
- 複数年度の比較機能
- PDFレポート出力

---

ご不明な点がございましたら、プロジェクトのIssueでお知らせください。
